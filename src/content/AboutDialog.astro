---
import Dialog from '../components/dialog/Dialog.astro';
import IconEnvelope from '../components/icons/IconEnvelope.astro';
import IconQuestionMark from '../components/icons/IconQuestionMark.astro';
import IconUser from '../components/icons/IconUser.astro';
import { getCurrentLanguage } from '../utils/i18n.ts';

// Import translation files
import noTranslations from '../locales/no.json';
import enTranslations from '../locales/en.json';

const currentLang = getCurrentLanguage();
const translations = currentLang === 'en' ? enTranslations : noTranslations;

// Helper function to replace placeholders in text
function replacePlaceholders(text: string, replacements: Record<string, string>): string {
  let result = text;
  for (const [key, value] of Object.entries(replacements)) {
    result = result.replace(`{${key}}`, value);
  }
  return result;
}
---

<Dialog id="about-dialog" outerClass="max-w-[550px]" innerClass="sm:pl-8">
  <h2 class="mt-1 text-2xl font-bold sm:mt-0 sm:text-3xl dark:text-slate-200">
    {translations.about.title}
  </h2>

  <hr
    class="-mx-5 mb-6 mt-4 sm:-ml-8 sm:-mr-12 sm:mb-8 sm:mt-5 dark:border-slate-800"
  />
  <div class="flex gap-4">
    <IconQuestionMark
      class="hidden h-7 w-7 shrink-0 stroke-2 text-gray-400 sm:block dark:text-blue-200"
    />
    <div>
      <h3 class="mb-1 text-xl font-bold text-gray-900 dark:text-slate-200">
        {translations.about.whatIs.title}
      </h3>
      <p class="mb-3 text-gray-700 dark:text-slate-400">
        {translations.about.whatIs.description1}
      </p>
      <p class="mb-6 text-gray-700 sm:mb-8 dark:text-slate-400">
        {translations.about.whatIs.description2}
      </p>
    </div>
  </div>

  <div class="flex gap-4">
    <IconUser
      class="hidden h-7 w-7 shrink-0 stroke-2 text-gray-400 sm:block dark:text-blue-200"
    />
    <div>
      <h3 class="mb-1 text-xl font-bold text-gray-900 dark:text-slate-200">
        {translations.about.whoMade.title}
      </h3>
      <p class="mb-6 text-gray-700 sm:mb-8 dark:text-slate-400">
        <Fragment set:html={replacePlaceholders(translations.about.whoMade.description, {
          authorLink: `<a href="https://mvn.no" id="mvn-link" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300">${translations.about.links.author}</a>`
        })} />
      </p>
    </div>
  </div>

  <div class="flex gap-4">
    <IconEnvelope
      class="hidden h-7 w-7 shrink-0 stroke-2 text-gray-400 sm:block dark:text-blue-200"
    />
    <div>
      <h3 class="mb-1 text-xl font-bold text-gray-900 dark:text-slate-200">
        {translations.about.feedback.title}
      </h3>
      <p class="text-gray-700 dark:text-slate-400">
        <Fragment set:html={replacePlaceholders(translations.about.feedback.description, {
          emailLink: `<a href="mailto:${translations.about.links.email}" id="email-link" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300">${translations.about.links.email}</a>`,
          githubLink: `<a href="https://github.com/mortnod/instabart" id="github-link" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300">${translations.about.links.github}</a>`
        })} />
      </p>
    </div>
  </div>
</Dialog>
